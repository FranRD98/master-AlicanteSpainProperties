<div class="row mb-4">
    <div class="col-md-6">
    </div>
    <div class="col-md-6 text-md-right">
        <span class="badge badge-secondary"><i class="fas fa-fw fa-calendar"></i> 05-05-2024</span>
    </div>
</div>

<div class="card mb-4">
    <ol class="ver-index">
        <li><a href="#uno"><i class="fas fz-fw fa-plus-circle text-success"></i> Actualizado el master a PHP 8.3</a></li>
        <li><a href="#dos"><i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Fallo metas de las areas</a></li>
        <li><a href="#tres"><i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Error en pages.php</a></li>
        <li><a href="#cuatro"><i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Al enviar una consulta de un inmueble no lo muestra en el email</a></li>
        <li><a href="#cinco"><i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> El calendario de la propiedad no muestra las fechas ocupadas</a></li>
        <li><a href="#seis"><i class="fas fz-fw fa-bug text-danger"></i> Fallos en los Alts de los quicklinks</a></li>
        <li><a href="#siete"><i class="fas fz-fw fa-bug text-danger"></i> Añadida carpeta thumbnails a la carpeta /media/images/news/</a></li>
        <li><a href="#ocho"><i class="fas fz-fw fa-bug text-danger"></i> No funciona el archivo /_install/check.php</a></li>
        <li><a href="#nueve"><i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> No funciona el archivo /modules/property/save_web.php</a></li>
        <li><a href="#diez"><i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Fallo al mostrar precios por días</a></li>
        <li><a href="#once"><i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Error en el sitemap.php</a></li>
        <li><a href="#doce"><i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Error en genimg.php</a></li>
        <li><a href="#trece"><i class="fas fz-fw fa-bug text-danger"></i> Error 500 al añadir referencia duplicada</a></li>
        <li><a href="#catorce"><i class="fas fz-fw fa-bug text-danger"></i> DatoDatos del propietario incorrecto en el form propiedaddad</a></li>
        <li><a href="#quince"><i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Actualizadas traducciones web: FR, NL y DE</a></li>
        <li><a href="#dieciseis"><i class="fas fz-fw fa-bug text-danger"></i> No se muestran eventos en la vista grid semana y día</a></li>
        <li><a href="#sec17"><i class="fas fz-fw fa-bug text-danger"></i> Se manda emails a clientes con código roto</a></li>
        <li><a href="#sec18"><i class="fas fz-fw fa-bug text-danger"></i> No se muestran las plantillas de emails en vendedores</a></li>
        <li><a href="#sec19"><i class="fas fz-fw fa-bug text-danger"></i> Al crear feeds si pone por referencias + de 4 solos salen esos 4 y no ves el resto de referencias</a></li>
        <li><a href="#sec20"><i class="fas fz-fw fa-bug text-danger"></i> Al mandar Newsletter general no sale la firma del user que la envía</a></li>
        <li><a href="#sec21"><i class="fas fz-fw fa-bug text-danger"></i> Cuando un usuario accede al CRM que solo se vean sus notificaciones</a></li>
        <li><a href="#sec22"><i class="fas fz-fw fa-bug text-danger"></i> Consultas: Attended pone mostrar en web</a></li>
        <li><a href="#sec23"><i class="fas fz-fw fa-bug text-danger"></i> Al asignar un buyer a un empleado que reciba un correo</a></li>
        <li><a href="#sec24"><i class="fas fz-fw fa-bug text-danger"></i> Canbiar respondido en inglés por Resolved</a></li>
        <li><a href="#sec25"><i class="fas fz-fw fa-bug text-danger"></i> Canbiar Atendido por en inglés por Agent/Employee</a></li>
        <li><a href="#sec26"><i class="fas fz-fw fa-bug text-danger"></i> Fix websites que importan muchos xmls y da timeout</a></li>
        <li><a href="#sec27"><i class="fas fz-fw fa-bug text-danger"></i> Fix velocidad al duplicar inmuebles</a></li>
        <li><a href="#sec28"><i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Si ocultas casas importadas desde XML, salen en la ficha de areas</a></li>
        <li><a href="#sec29"><i class="fas fz-fw fa-bug text-danger"></i> Ajustar comprobación de compradores duplicados</a></li>
        <li><a href="#sec30"><i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> En el blog no se cambian las etiquetas image por las imágenes</a></li>
        <li><a href="#sec31"><i class="fas fz-fw fa-bug text-danger"></i> Cuando se inserto un comprador no se refleja la fecha de cuando se añadió</a></li>
        <li><a href="#sec32"><i class="fas fz-fw fa-bug text-danger"></i> El nivel agente no pueden ver todas las casas en la pestaña de Matching</a></li>
        <li><a href="#sec33"><i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Las tags del blog no funcionan</a></li>
        <li><a href="#sec34"><i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Cuando filtras por tags o categorías, la numeración de la paginación no se actualiza</a></li>
    </ol>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="uno">
        <span class="badge badge-dark">1</span> <i class="fas fz-fw fa-plus-circle text-success"></i> Actualizado el master a PHP 8.3
    </h6>
    <div class="card-body">
        <b>Se ha actualizado el master para funcionar con la versión de PHP 8.3</b>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="dos">
        <span class="badge badge-dark">2</span> <i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Fallo metas de las areas
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/modules/ciudades/properties.php:25
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
news.content_&quot;.$lang.&quot;_nws as contenido,
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
news.content_&quot;.$lang.&quot;_nws as contenido,
news.description_&quot;.$lang.&quot;_nws as contenidow,
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="tres">
        <span class="badge badge-dark">3</span> <i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Error en pages.php
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/modules/pages/pages.php:93
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
if (count($matches[0] &gt; 0)) {
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
if (count($matches[0]) &gt; 0) {
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="cuatro">
        <span class="badge badge-dark">4</span> <i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Al enviar una consulta de un inmueble no lo muestra en el email
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/modules/property/enquiry.php:31
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$comment = simpleSanitize($_GET[&#039;comment&#039;]);
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$comment = simpleSanitize($_GET[&#039;comment&#039;]);

$langVal = $lang;
$idVal = $id;
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="cinco">
        <span class="badge badge-dark">5</span> <i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> El calendario de la propiedad no muestra las fechas ocupadas
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/modules/property/disp-json.php:41
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$colname_Recordset1 = sanitizeInput($_GET[&#039;p&#039;]);
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$colname_Recordset1 = simpleSanitize($_GET[&#039;p&#039;]);
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="seis">
        <span class="badge badge-dark">6</span> <i class="fas fz-fw fa-bug text-danger"></i> Fallos en los Alts de los quicklinks
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/quicklinks/images_alts.php:93
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$set  .= &quot;`&quot;.$nom.&quot;` =  &#039;&quot;.mysqli_real_escape_string($_GET[$nom]).&quot;&#039;&quot;;
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$set  .= &quot;`&quot;.$nom.&quot;` =  &#039;&quot;.mysqli_real_escape_string($inmoconn, $_GET[$nom]).&quot;&#039;&quot;;
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="siete">
        <span class="badge badge-dark">7</span> <i class="fas fz-fw fa-bug text-danger"></i> Añadida carpeta thumbnails a la carpeta /media/images/news/
    </h6>
    <div class="card-body">
        la carpeta media/images/news/thumbnails no existe, hay que añadirla
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="ocho">
        <span class="badge badge-dark">8</span> <i class="fas fz-fw fa-bug text-danger"></i> No funciona el archivo /_install/check.php
    </h6>
    <div class="card-body">
        Susutituir el archivo /_install/check.php por el de este master.
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="nueve">
        <span class="badge badge-dark">9</span> <i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> No funciona el archivo /modules/property/save_web.php
    </h6>
    <div class="card-body">
        Susutituir el archivo /modules/property/save_web.php por el de este master.
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="diez">
        <span class="badge badge-dark">10</span> <i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Fallo al mostrar precios por días
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/modules/property/view/partials/tabs-panels.tpl:84
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
{if isset($property[0].price_prc) &amp;&amp; $precios[0].price_prc != &#039;&#039;}
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
{if isset($precios[0].price_prc) &amp;&amp; $precios[0].price_prc != &#039;&#039;}
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="once">
        <span class="badge badge-dark">11</span> <i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Error en sitemap.php
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/sitemap.php:12
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
foreach ($urlStr as $key =&gt; $urls) {
    foreach ($urls as $langval =&gt; $urlval) {
        if ($langval == $lang) {
            $urlStr[$key][&#039;url&#039;] = $urlval;
            $urlStr[$urlStr[$key][$langval]][&#039;master&#039;] = $key;
            // $smarty-&gt;assign(&#039;url_key&#039;, $key);

        }
    }
    if ($urlval[&#039;mostrar-en-sitemap&#039;] == 1) {
        if ($key == &#039;sell-your-property&#039;) {
            if ($actVenderPropiedad == 1) {
                array_push($url_staticas, $key);
            }
        } else {
            array_push($url_staticas, $key);
        }


    }
}
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
foreach ($urlStr as $key =&gt; $urls) {
    foreach ($urls as $langval =&gt; $urlval) {
        if ($langval == $lang) {
            $urlStr[$key][&#039;url&#039;] = $urlval;

            if (is_array($urlStr[$key]) &amp;&amp; isset($urlStr[$key][$langval])) {
                $urlStr[$urlStr[$key][$langval]][&#039;master&#039;] = $key;
            }
        }
    }

    if (isset($urlval[&#039;mostrar-en-sitemap&#039;]) &amp;&amp; $urlval[&#039;mostrar-en-sitemap&#039;] == 1) {
        if ($key == &#039;sell-your-property&#039;) {
            if (isset($actVenderPropiedad) &amp;&amp; $actVenderPropiedad == 1) {
                array_push($url_staticas, $key);
            }
        } else {
            array_push($url_staticas, $key);
        }
    }
}
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="doce">
        <span class="badge badge-dark">12</span> <i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Error en genimg.php
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/genimg.php:97
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
if (eregi(&quot;^http&quot;, $value[&#039;image_img&#039;])) {
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
if (preg_match(&quot;/^http/i&quot;, $value[&#039;image_img&#039;])) {
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/genimg.php:113
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
mysqli_select_db($database_inmoconn, $inmoconn);
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
mysqli_select_db($inmoconn, $database_inmoconn);
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="trece">
        <span class="badge badge-dark">13</span> <i class="fas fz-fw fa-bug text-danger"></i> Error 500 al añadir referencia duplicada
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/properties-form.php:867
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
//end Trigger_Fotocasa_Delete trigger
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
//end Trigger_Fotocasa_Delete trigger

//start Trigger_CheckUnique trigger
//remove this line if you want to edit the code by hand
function Trigger_CheckUnique(&amp;$tNG) {
  global $lang, $database_inmoconn, $inmoconn;
  $tblFldObj = new tNG_CheckUnique($tNG);
  $tblFldObj-&gt;setTable(&quot;properties_properties&quot;);
  $tblFldObj-&gt;addFieldName(&quot;referencia_prop&quot;);
  $tblFldObj-&gt;setErrorMsg(&quot;Registro duplicado: {referencia_prop}&quot;);

  return $tblFldObj-&gt;Execute();
}
//end Trigger_CheckUnique trigger
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/properties-form.php:922
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$ins_properties_properties-&gt;registerTrigger(&quot;AFTER&quot;, &quot;removeCache&quot;, 90);
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$ins_properties_properties-&gt;registerTrigger(&quot;AFTER&quot;, &quot;removeCache&quot;, 90);
$ins_properties_properties-&gt;registerTrigger(&quot;BEFORE&quot;, &quot;Trigger_CheckUnique&quot;, 15);
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/properties-form.php:1168
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$upd_properties_properties-&gt;registerTrigger(&quot;AFTER&quot;, &quot;removeCache&quot;, 90);
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$upd_properties_properties-&gt;registerTrigger(&quot;AFTER&quot;, &quot;removeCache&quot;, 90);
$upd_properties_properties-&gt;registerTrigger(&quot;BEFORE&quot;, &quot;Trigger_CheckUnique&quot;, 30);
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="catorce">
        <span class="badge badge-dark">14</span> <i class="fas fz-fw fa-bug text-danger"></i> Datos del propietario incorrecto en el form propiedad
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/owner-data.php:121
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
&lt;p&gt;&lt;b&gt;&lt;?php echo $lang[&#039;Skype&#039;] ?&gt;:&lt;/b&gt; &lt;?php echo $row_rsOwner[&#039;skype_pro&#039;] ?&gt;&lt;/p&gt;
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
&lt;p&gt;&lt;b&gt;&lt;?php echo $lang[&#039;Partner Portal / Dropbox&#039;] ?&gt;:&lt;/b&gt; &lt;?php echo $row_rsOwner[&#039;skype_pro&#039;] ?&gt;&lt;/p&gt;
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>


<div class="card mb-4">
    <h6 class="card-header" id="quince">
        <span class="badge badge-dark">15</span> <i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Actualizadas traducciones web: FR, NL y DE
    </h6>
    <div class="card-body">
        Actualizados los archivos:
        <br>/resources/lang_fr.php
        <br>/resources/lang_nl.php
        <br>/resources/lang_de.php
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>


<div class="card mb-4">
    <h6 class="card-header" id="dieciseis">
        <span class="badge badge-dark">16</span> <i class="fas fz-fw fa-bug text-danger"></i> No se muestran eventos en la vista grid semana y día
    </h6>
    <div class="card-body">
        Sustituir el archivo: /intramedianet/includes/assets/_custom/vendor/fullcalendar/dist/fullcalendar.js
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>


<div class="card mb-4">
    <h6 class="card-header" id="sec17">
        <span class="badge badge-dark">17</span> <i class="fas fz-fw fa-bug text-danger"></i> Se manda emails a clientes con código roto
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/clients-form.php:3243
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
intr_txt[&#039;&lt;?php echo $langval ?&gt;&lt;?php echo $row_rsTemplates[&#039;id_tmpl&#039;]?&gt;&#039;] = &quot;&lt;?php echo mysqli_real_escape_string($inmoconn,$row_rsTemplates[&#039;content_&#039;.$langval.&#039;_tmpl&#039;]); ?&gt;&quot;;
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
intr_txt[&#039;&lt;?php echo $langval ?&gt;&lt;?php echo $row_rsTemplates[&#039;id_tmpl&#039;]?&gt;&#039;] = &quot;&lt;?php echo mysqli_real_escape_string(strip_tags($inmoconn,$row_rsTemplates[&#039;content_&#039;.$langval.&#039;_tmpl&#039;])); ?&gt;&quot;;
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>


<div class="card mb-4">
    <h6 class="card-header" id="sec18">
        <span class="badge badge-dark">18</span> <i class="fas fz-fw fa-bug text-danger"></i> No se muestran las plantillas de emails en vendedores
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/owners-form.php:143
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$query_rsNationalities = &quot;SELECT id_ncld, nacionalidad_&quot;.$lang_adm.&quot;_ncld FROM nacionalidades ORDER BY nacionalidad_&quot;.$lang_adm.&quot;_ncld&quot;;
$rsNationalities = mysqli_query($inmoconn,$query_rsNationalities) or die(mysqli_error());
$row_rsNationalities = mysqli_fetch_assoc($rsNationalities);
$totalRows_rsNationalities = mysqli_num_rows($rsNationalities);
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$query_rsNationalities = "SELECT id_ncld, nacionalidad_nl_ncld FROM nacionalidades ORDER BY nacionalidad_nl_ncld";
$rsNationalities = mysqli_query($inmoconn,$query_rsNationalities) or die(mysqli_error());
$row_rsNationalities = mysqli_fetch_assoc($rsNationalities);
$totalRows_rsNationalities = mysqli_num_rows($rsNationalities);

mysql_select_db($database_inmoconn, $inmoconn);
$query_rsTemplates = "SELECT * FROM templates ORDER BY name_nl_tmpl ASC";
$rsTemplates = mysql_query($query_rsTemplates, $inmoconn) or die(mysql_error());
$row_rsTemplates = mysql_fetch_assoc($rsTemplates);
$totalRows_rsTemplates = mysql_num_rows($rsTemplates);
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/owners-form.php:1250
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
&lt;div class=&quot;tab-pane&quot; id=&quot;tabsend&quot;&gt;

    &lt;div class=&quot;card position-relative&quot;&gt;
        &lt;div class=&quot;card-header align-items-center d-flex&quot;&gt;
            &lt;div class=&quot;flex-grow-1 oveflow-hidden&quot;&gt;
                &lt;h4 class=&quot;card-title mb-0 flex-grow-1&quot;&gt;&lt;?php __(&#039;Enviar&#039;); ?&gt; &lt;?php __(&#039;Email&#039;); ?&gt;&lt;/h4&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class=&quot;card-body&quot;&gt;

            &lt;div class=&quot;mb-4&quot;&gt;
                &lt;label for=&quot;subjectSM&quot; class=&quot;form-label&quot;&gt;&lt;?php __(&#039;Asunto&#039;); ?&gt;:&lt;/label&gt;
                &lt;input type=&quot;text&quot; name=&quot;subjectSM&quot; id=&quot;subjectSM&quot; class=&quot;form-control required&quot;&gt;
            &lt;/div&gt;

            &lt;div class=&quot;form-group&quot;&gt;
                &lt;label for=&quot;email_cli&quot; class=&quot;form-label&quot;&gt;&lt;?php __(&#039;Mensaje&#039;); ?&gt;:&lt;/label&gt;
                &lt;textarea name=&quot;messagemail&quot; id=&quot;messagemail&quot; cols=&quot;30&quot; rows=&quot;15&quot; class=&quot;form-control required&quot;&gt;&lt;/textarea&gt;
            &lt;/div&gt;

            &lt;div class=&quot;text-end&quot;&gt;
                &lt;a href=&quot;#&quot; class=&quot;btn btn-primary btn-sm btnsendemail me-2&quot; style=&quot;border-radius: 0 0 5px 5px;&quot;&gt;&lt;i class=&quot;fa-regular fa-paper-plane me-1&quot;&gt;&lt;/i&gt; &lt;?php echo $lang[&#039;Enviar&#039;] ?&gt;&lt;/a&gt;
                &lt;a href=&quot;#&quot; class=&quot;btn btn-success btn-sm btnwhatsapp me-2&quot; style=&quot;border-radius: 0 0 5px 5px;&quot; target=&quot;_blank&quot;&gt;&lt;i class=&quot;fa-brands fa-whatsapp me-1&quot;&gt;&lt;/i&gt; &lt;?php echo $lang[&#039;Enviar&#039;] ?&gt;: WhatsApp&lt;/a&gt;
            &lt;/div&gt;

        &lt;/div&gt;&lt;!-- end card-body --&gt;
    &lt;/div&gt;

&lt;/div&gt;
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
&lt;div class=&quot;tab-pane&quot; id=&quot;tabsend&quot;&gt;

    &lt;div class=&quot;card position-relative&quot;&gt;
        &lt;div class=&quot;card-header align-items-center d-flex&quot;&gt;
            &lt;div class=&quot;flex-grow-1 oveflow-hidden&quot;&gt;
                &lt;h4 class=&quot;card-title mb-0 flex-grow-1&quot;&gt;&lt;?php __(&#039;Enviar&#039;); ?&gt; &lt;?php __(&#039;Email&#039;); ?&gt;&lt;/h4&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class=&quot;card-body&quot;&gt;

            &lt;div class=&quot;mb-4&quot;&gt;
                &lt;label for=&quot;subjectSM&quot; class=&quot;form-label&quot;&gt;&lt;?php __(&#039;Asunto&#039;); ?&gt;:&lt;/label&gt;
                &lt;input type=&quot;text&quot; name=&quot;subjectSM&quot; id=&quot;subjectSM&quot; class=&quot;form-control required&quot;&gt;
            &lt;/div&gt;

            &lt;div class=&quot;form-group&quot;&gt;
                &lt;label for=&quot;email_cli&quot; class=&quot;form-label&quot;&gt;&lt;?php __(&#039;Mensaje&#039;); ?&gt;:&lt;/label&gt;
                &lt;textarea name=&quot;messagemail&quot; id=&quot;messagemail&quot; cols=&quot;30&quot; rows=&quot;15&quot; class=&quot;form-control required&quot;&gt;&lt;/textarea&gt;
            &lt;/div&gt;

            &lt;div class=&quot;row&quot;&gt;
                &lt;div class=&quot;col-md-6&quot;&gt;
                    &lt;div class=&quot;form-group&gt;&quot;&gt;
                        &lt;label for=&quot;txt&quot; class=&quot;form-label&quot;&gt;&lt;?php __(&#039;Texto&#039;); ?&gt;:&lt;/label&gt;
                        &lt;select name=&quot;txt&quot; id=&quot;txt&quot; class=&quot;form-select&quot;&gt;
                            &lt;option value=&quot;&quot;&gt;&lt;?php __(&#039;Seleccione uno&#039;); ?&gt;...&lt;/option&gt;
                            &lt;?php do { ?&gt;
                            &lt;option value=&quot;&lt;?php echo $row_rsTemplates[&#039;id_tmpl&#039;]?&gt;&quot;&gt;&lt;?php echo $row_rsTemplates[&#039;name_&#039;.$lang_adm.&#039;_tmpl&#039;]?&gt;&lt;/option&gt;
                            &lt;?php } while ($row_rsTemplates = mysqli_fetch_assoc($rsTemplates));
                              $rows = mysqli_num_rows($rsTemplates);
                              if($rows &gt; 0) {
                                  mysqli_data_seek($rsTemplates, 0);
                                $row_rsTemplates = mysqli_fetch_assoc($rsTemplates);
                              } ?&gt;
                        &lt;/select&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class=&quot;col-md-3 mb-3&quot;&gt;
                    &lt;div class=&quot;form-group&gt;&quot;&gt;
                        &lt;label for=&quot;ref&quot; class=&quot;form-label&quot;&gt;&lt;?php __(&#039;Referencia&#039;); ?&gt;:&lt;/label&gt;
                        &lt;input type=&quot;text&quot; class=&quot;select2references3&quot; id=&quot;ref&quot; name=&quot;ref&quot; value=&quot;&quot; tabindex=&quot;-1&quot;&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class=&quot;col-md-3 mb-3&quot;&gt;
                    &lt;div class=&quot;form-group&quot; class=&quot;form-label&quot;&gt;
                        &lt;br&gt;
                        &lt;a href=&quot;#&quot; class=&quot;btn btn-info btn-block btn-txt&quot;&gt;&lt;?php __(&#039;Aplicar&#039;); ?&gt;&lt;/a&gt;
                        &lt;a href=&quot;/intramedianet/templates/news.php&quot; target=&quot;_blank&quot; class=&quot;btn btn-primary&quot;&gt;&lt;?php __(&#039;Plantillas correo&#039;); ?&gt;&lt;/a&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;a href=&quot;#&quot; class=&quot;btn btn-primary btnsendemail&quot;&gt;&lt;i class=&quot;fa-regular fa-paper-plane me-1&quot;&gt;&lt;/i&gt; &lt;?php echo $lang[&#039;Enviar Respuesta/Email&#039;] ?&gt;&lt;/a&gt;
            &lt;a href=&quot;#&quot; class=&quot;btn btn-success btnwhatsapp mt-4 mt-md-0&quot; target=&quot;_blank&quot;&gt;&lt;i class=&quot;fa-brands fa-whatsapp me-1&quot;&gt;&lt;/i&gt; &lt;?php echo $lang[&#039;Enviar&#039;] ?&gt;: WhatsApp&lt;/a&gt;
        &lt;/div&gt;&lt;!-- end card-body --&gt;
    &lt;/div&gt;

&lt;/div&gt;
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/owners-form.php:1544
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
<script src="_js/owners-form.js" type="text/javascript"></script>
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
&lt;script src=&quot;_js/owners-form.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;

&lt;script&gt;
    var intr_sub = new Array();
    var intr_txt = new Array();

    &lt;?php do { ?&gt;
      &lt;?php foreach ($languages as $langval): ?&gt;
      intr_sub[&#039;&lt;?php echo $langval ?&gt;&lt;?php echo $row_rsTemplates[&#039;id_tmpl&#039;]?&gt;&#039;] = &quot;&lt;?php echo mysqli_real_escape_string($inmoconn, $row_rsTemplates[&#039;subject_&#039;.$langval.&#039;_tmpl&#039;]); ?&gt;&quot;;
      intr_txt[&#039;&lt;?php echo $langval ?&gt;&lt;?php echo $row_rsTemplates[&#039;id_tmpl&#039;]?&gt;&#039;] = &quot;&lt;?php echo mysqli_real_escape_string($inmoconn, strip_tags($row_rsTemplates[&#039;content_&#039;.$langval.&#039;_tmpl&#039;])); ?&gt;&quot;;

      &lt;?php endforeach ?&gt;
    &lt;?php } while ($row_rsTemplates = mysqli_fetch_assoc($rsTemplates));
    $rows = mysqli_num_rows($rsTemplates);
    if($rows &gt; 0) {
        mysqli_data_seek($rsTemplates, 0);
      $row_rsTemplates = mysqli_fetch_assoc($rsTemplates);
    } ?&gt;



    $(&#039;.btn-txt&#039;).click(function(e) {
        e.preventDefault();
        if ($(&#039;#txt&#039;).val() == &#039;&#039;) {
            alert(&#039;&lt;?php __(&#039;Seleccione un texto&#039;); ?&gt;&#039;);
            $(&#039;#txt&#039;).focus();
            return false;
        }
        $(&#039;#subjectSM&#039;).val(intr_sub[$(&#039;#idioma_pro&#039;).val()+$(&#039;#txt&#039;).val()]);
        var txt = intr_txt[$(&#039;#idioma_pro&#039;).val()+$(&#039;#txt&#039;).val()];
        $(&#039;#messagemail&#039;).val(txt.replace(&#039;{{PROPERTY}}&#039;, &#039;{{PROPERTY-&#039; + $(&#039;#ref&#039;).val() + &#039;}}&#039;));
        return false;
    });

    $(&#039;.btn-txt2&#039;).click(function(e) {
        e.preventDefault();
        if ($(&#039;#txt2&#039;).val() == &#039;&#039;) {
            alert(&#039;&lt;?php __(&#039;Seleccione un texto&#039;); ?&gt;&#039;);
            $(&#039;#txt2&#039;).focus();
            return false;
        }
        var txt = intr_txt[$(&#039;#idioma_pro&#039;).val()+$(&#039;#txt2&#039;).val()].replace(&#039;{{PROPERTY}}&#039;, &#039;&#039;);
        $(&#039;#comment&#039;).redactor(&#039;source.setCode&#039;, txt);
        return false;
    });
&lt;/script&gt;
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/owners-form.php:1958
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$(&#039;.btnwhatsapp&#039;).click(function(e) {
e.preventDefault();
if (!$(&#039;#telefono_fijo_pro&#039;).val()) {
    alert(Nophone);
    return false;
}
if ($(&#039;#messagemail&#039;).val() == &#039;&#039;) {
    alert(strFieldMessage);
    return false;
}
sendLang = &#039;en&#039;;
if ($(&#039;#idioma_cli&#039;).val() != &#039;&#039;) {
  sendLang = $(&#039;#idioma_cli&#039;).val();
}
if (!confirm(cliMailConf)) {
  return false;
}

var values = Array();
var priceRegex = /([0-9]+)/;
for (var i = 0; i &lt; selected.length; i++) {
    // var match = selected[i].match(priceRegex);
    // values.push(match[1]);
    values.push(selected[i]);
}
values = values.join(&#039;,&#039;);

var url =  &quot;get-links2.php?ids=&quot;+values+&#039;&amp;phone=&#039;+$(&#039;#telefono_fijo_pro&#039;).val()+&#039;&amp;comment=&#039;+encodeURIComponent($(&#039;#messagemail&#039;).val())+&#039;&amp;lang=&#039; + sendLang;

window.open(url, &quot;whatsapp&quot;);
});
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$(&#039;.btnwhatsapp&#039;).click(function(e) {
e.preventDefault();
if (!$(&#039;#telefono_fijo_pro&#039;).val()) {
    alert(Nophone);
    return false;
}
if ($(&#039;#messagemail&#039;).val() == &#039;&#039;) {
    alert(strFieldMessage);
    return false;
}
sendLang = &#039;en&#039;;
if ($(&#039;#idioma_cli&#039;).val() != &#039;&#039;) {
  sendLang = $(&#039;#idioma_cli&#039;).val();
}
if (!confirm(cliMailConf)) {
  return false;
}

var values = Array();
var priceRegex = /([0-9]+)/;
for (var i = 0; i &lt; selected.length; i++) {
    // var match = selected[i].match(priceRegex);
    // values.push(match[1]);
    values.push(selected[i]);
}
values = values.join(&#039;,&#039;);

var url =  &quot;get-links2.php?ids=&quot;+values+&#039;&amp;phone=&#039;+$(&#039;#telefono_fijo_pro&#039;).val()+&#039;&amp;comment=&#039;+encodeURIComponent($(&#039;#messagemail&#039;).val())+&#039;&amp;lang=&#039; + sendLang;

window.open(url, &quot;whatsapp&quot;);
});

$(&#039;.select2references3&#039;).select2({
    multiple:true,
    ajax: {
    url: function (params) {
        return &#039;/intramedianet/properties/properties-references-select.php?q=&#039; + params;
    },
    dataType: &#039;json&#039;,
    delay: 250,
    results: function (data, params) {
        return {
            results: data.results
        };
    },
    // cache: true,
    },
    placeholder: &#039;&#039;,
    minimumInputLength: 3,
});
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>


<div class="card mb-4">
    <h6 class="card-header" id="sec19">
        <span class="badge badge-dark">19</span> <i class="fas fz-fw fa-bug text-danger"></i> Al crear feeds si pone por referencias + de 4 solos salen esos 4 y no ves el resto de referencias
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/xml/exportar-form.php:227
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
&lt;link rel=&quot;stylesheet&quot; href=&quot;/intramedianet/includes/assets/_custom/vendor/ion.rangeSlider/css/ion.rangeSlider.skinNice.css&quot;&gt;
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
&lt;link rel=&quot;stylesheet&quot; href=&quot;/intramedianet/includes/assets/_custom/vendor/ion.rangeSlider/css/ion.rangeSlider.skinNice.css&quot;&gt;

&lt;style&gt;
.select2-container-multi .select2-choices {
    height: auto!important;
    max-height: 1000px!important;
}
&lt;/style&gt;
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>


<div class="card mb-4">
    <h6 class="card-header" id="sec20">
        <span class="badge badge-dark">20</span> <i class="fas fz-fw fa-bug text-danger"></i> Al mandar Newsletter general no sale la firma del user que la envía
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/acumbamail/send.php:99
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
if (!empty($_GET[&#039;propsnews3&#039;])) {
    // $body .= &#039;&lt;div style=&quot;background: #f6f6f6; margin: 40px -37px -60px -37px; padding: 1px 37px 30px 37px;&quot;&gt;&#039;;
    $body  .= &quot;&lt;h2 style=\&quot;margin: 40px 0;\&quot;&gt;&quot;.$langStr[&quot;Noticias&quot;].&quot;&lt;/h2&gt;&quot;;
    foreach ($_GET[&#039;propsnews3&#039;] as $value) {
        $langVal = $_GET[&#039;lang&#039;];
        $idVal = $value;
        ob_start();
        include($_SERVER[&quot;DOCUMENT_ROOT&quot;] . &#039;/modules/mail_partials/news-acumba.php&#039;);
        $body .= ob_get_contents();
        ob_end_clean();
    }
    // $body .= &#039;&lt;/div&gt;&#039;;
}
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
if (!empty($_GET[&#039;propsnews3&#039;])) {
    // $body .= &#039;&lt;div style=&quot;background: #f6f6f6; margin: 40px -37px -60px -37px; padding: 1px 37px 30px 37px;&quot;&gt;&#039;;
    $body  .= &quot;&lt;h2 style=\&quot;margin: 40px 0;\&quot;&gt;&quot;.$langStr[&quot;Noticias&quot;].&quot;&lt;/h2&gt;&quot;;
    foreach ($_GET[&#039;propsnews3&#039;] as $value) {
        $langVal = $_GET[&#039;lang&#039;];
        $idVal = $value;
        ob_start();
        include($_SERVER[&quot;DOCUMENT_ROOT&quot;] . &#039;/modules/mail_partials/news-acumba.php&#039;);
        $body .= ob_get_contents();
        ob_end_clean();
    }
    // $body .= &#039;&lt;/div&gt;&#039;;
}

$signature = &#039;&#039;;
if ($_SESSION[&#039;kt_login_id&#039;]) {
    $query_rsAdmin = &quot;SELECT * FROM users WHERE id_usr = &#039;&quot;.$_SESSION[&#039;kt_login_id&#039;].&quot;&#039;&quot;;
    $rsAdmin = mysqli_query($inmoconn, $query_rsAdmin) or die(mysqli_error());
    $row_rsAdmin = mysqli_fetch_assoc($rsAdmin);
    $totalRows_rsAdmin = mysqli_num_rows($rsAdmin);

    if ($row_rsAdmin[&#039;firma_&#039; . $_GET[&#039;lang&#039;] . &#039;_usr&#039;] != &#039;&#039;) {
        $signature = &#039;&lt;div style=&quot;font-size: 14px;&quot;&gt;&#039;;
        $signature .= nl2br($row_rsAdmin[&#039;firma_&#039; . $_GET[&#039;lang&#039;] . &#039;_usr&#039;]);
        $signature .= &#039;&lt;/div&gt;&#039;;
    }
}

$body = $body . $signature;
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>


<div class="card mb-4">
    <h6 class="card-header" id="sec21">
        <span class="badge badge-dark">21</span> <i class="fas fz-fw fa-bug text-danger"></i> Cuando un usuario accede al CRM que solo se vean sus notificaciones
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/includes/inc.topbar.php:41
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
&lt;?php if ($actClients == 1 || $actPropietarios == 1): ?&gt;
    &lt;?php
    $query_rsLlamadasDeman = &quot;
    SELECT
     id_cli
    FROM   properties_client
    WHERE next_call_cli != &#039;&#039; AND next_call_cli &lt;= NOW()
    ORDER BY next_call_cli ASC
    &quot;;
    $rsLlamadasDeman = $inmoconn-&gt;query($query_rsLlamadasDeman); if(!$rsLlamadasDeman) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
    $row_rsLlamadasDeman = mysqli_fetch_assoc($rsLlamadasDeman);
    $totalRows_rsLlamadasDeman = mysqli_num_rows($rsLlamadasDeman);

    $query_rsLlamadasProp = &quot;
    SELECT
        id_pro
        FROM properties_owner
        WHERE next_call_pro != &#039;0000-00-00&#039;  AND next_call_pro &lt;= NOW()
        ORDER BY next_call_pro ASC
    &quot;;
    $rsLlamadasProp = $inmoconn-&gt;query($query_rsLlamadasProp); if(!$rsLlamadasProp) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
    $row_rsLlamadasProp = mysqli_fetch_assoc($rsLlamadasProp);
    $totalRows_rsLlamadasProp = mysqli_num_rows($rsLlamadasProp);

    ?&gt;
    &lt;div class=&quot;ms-1 header-item&quot;&gt;
        &lt;a href=&quot;/intramedianet/llamadas/clients.php&quot; class=&quot;btn btn-icon btn-topbar btn-ghost-secondary rounded-circle&quot;&gt;
            &lt;i class=&quot;fa-regular fa-phone fs-22 fw- fw-light&quot;&gt;&lt;/i&gt;
            &lt;?php if($totalRows_rsLlamadasDeman &gt; 0 || $totalRows_rsLlamadasProp &gt; 0) { ?&gt;
            &lt;span class=&quot;position-absolute topbar-badge fs-10 translate-middle badge rounded-pill bg-danger&quot;&gt;&lt;?php echo $totalRows_rsLlamadasDeman + $totalRows_rsLlamadasProp; ?&gt;&lt;/span&gt;
            &lt;?php } ?&gt;
        &lt;/a&gt;
    &lt;/div&gt;
&lt;?php endif ?&gt;

&lt;?php if ($actTasks == 1) { ?&gt;
    &lt;?php
    $sWhere = &#039; WHERE DATE(date_due_tsk) &lt;= CURRENT_DATE() AND status_tsk != 2 &#039;;
    if ($_SESSION[&#039;kt_login_level&#039;] &lt; 9) {
        $sWhere .= &#039; AND admin_tsk = &#039; . $_SESSION[&#039;kt_login_id&#039;];
    }

    $query_rsTotalTareas = &quot;
    SELECT
        id_tsk
    FROM tasks
    $sWhere
    &quot;;

    $rsTotalTareas = $inmoconn-&gt;query($query_rsTotalTareas); if(!$rsTotalTareas) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
    $row_rsTotalTareas = mysqli_fetch_assoc($rsTotalTareas);
    $totalRows_rsTotalTareas = mysqli_num_rows($rsTotalTareas);

    ?&gt;
    &lt;div class=&quot;ms-1 header-item&quot;&gt;
        &lt;a href=&quot;/intramedianet/tasks/tasks.php&quot; class=&quot;btn btn-icon btn-topbar btn-ghost-secondary rounded-circle&quot;&gt;
            &lt;i class=&quot;fa-regular fa-list-check fs-22 fw- fw-light&quot;&gt;&lt;/i&gt;
            &lt;?php if($totalRows_rsTotalTareas &gt; 0) { ?&gt;&lt;span class=&quot;position-absolute topbar-badge fs-10 translate-middle badge rounded-pill bg-danger&quot;&gt;&lt;?php echo $totalRows_rsTotalTareas; ?&gt;&lt;/span&gt;&lt;?php } ?&gt;
        &lt;/a&gt;
    &lt;/div&gt;
&lt;?php } ?&gt;

&lt;?php if ($actCalendar == 1): ?&gt;
&lt;?php

$query_rsTotalEventos = &quot;SELECT citas.id_ct, citas_categories.category_en_ct, citas.inicio_ct, citas.final_ct, citas.titulo_ct FROM citas INNER JOIN citas_categories ON citas.categoria_ct = citas_categories.id_ct WHERE user_ct = &#039;&quot; . $_SESSION[&#039;kt_login_id&#039;] . &quot;&#039; AND  citas.inicio_ct &gt;= CURRENT_DATE() ORDER BY citas.inicio_ct ASC&quot;;
$rsTotalEventos = $inmoconn-&gt;query($query_rsTotalEventos); if(!$rsTotalEventos) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
$row_rsTotalEventos = mysqli_fetch_assoc($rsTotalEventos);
$totalRows_rsTotalEventos = mysqli_num_rows($rsTotalEventos);
?&gt;
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
&lt;?php if ($actClients == 1 || $actPropietarios == 1): ?&gt;
    &lt;?php

    if ($_SESSION[&#039;kt_login_level&#039;] == 9) {
            $query_rsLlamadasDeman = &quot;
            SELECT
             id_cli
            FROM   properties_client
            WHERE next_call_cli != &#039;&#039; AND next_call_cli &lt;= NOW()
            ORDER BY next_call_cli ASC
            &quot;;
            $rsLlamadasDeman = $inmoconn-&gt;query($query_rsLlamadasDeman); if(!$rsLlamadasDeman) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
            $row_rsLlamadasDeman = mysqli_fetch_assoc($rsLlamadasDeman);
            $totalRows_rsLlamadasDeman = mysqli_num_rows($rsLlamadasDeman);

            $query_rsLlamadasProp = &quot;
            SELECT
                id_pro
                FROM properties_owner
                WHERE next_call_pro != &#039;0000-00-00&#039;  AND next_call_pro &lt;= NOW()
                ORDER BY next_call_pro ASC
            &quot;;
            $rsLlamadasProp = $inmoconn-&gt;query($query_rsLlamadasProp); if(!$rsLlamadasProp) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
            $row_rsLlamadasProp = mysqli_fetch_assoc($rsLlamadasProp);
            $totalRows_rsLlamadasProp = mysqli_num_rows($rsLlamadasProp);
      } else {
            $query_rsLlamadasDeman = &quot;
                SELECT SQL_CALC_FOUND_ROWS
                 id_cli
                FROM properties_client
                 WHERE next_call_cli != &#039;&#039;  AND atendido_por_cli = &#039;&quot;.$_SESSION[&#039;kt_login_id&#039;].&quot;&#039;
            &quot;;
            $rsLlamadasDeman = $inmoconn-&gt;query($query_rsLlamadasDeman); if(!$rsLlamadasDeman) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
            $row_rsLlamadasDeman = mysqli_fetch_assoc($rsLlamadasDeman);
            $totalRows_rsLlamadasDeman = mysqli_num_rows($rsLlamadasDeman);

            $query_rsLlamadasProp = &quot;
            SELECT
                id_pro
                FROM properties_owner
                WHERE next_call_pro != &#039;0000-00-00&#039;  AND next_call_pro &lt;= NOW()
                ORDER BY next_call_pro ASC
            &quot;;
            $rsLlamadasProp = $inmoconn-&gt;query($query_rsLlamadasProp); if(!$rsLlamadasProp) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
            $row_rsLlamadasProp = mysqli_fetch_assoc($rsLlamadasProp);
            $totalRows_rsLlamadasProp = mysqli_num_rows($rsLlamadasProp);
        if($sWhere != &#039;&#039;) {
            $sWhere .= &quot; AND  next_call_pro != &#039;&#039;  AND captado_por_pro = &#039;&quot; . $_SESSION[&#039;kt_login_id&#039;] . &quot;&#039; &quot;; //
        } else {
            $sWhere .= &quot;  WHERE  next_call_pro != &#039;&#039;  AND captado_por_pro = &#039;&quot; . $_SESSION[&#039;kt_login_id&#039;]. &quot;&#039; &quot;; //
        }
      }

    ?&gt;
    &lt;div class=&quot;ms-1 header-item&quot;&gt;
        &lt;a href=&quot;/intramedianet/llamadas/clients.php&quot; class=&quot;btn btn-icon btn-topbar btn-ghost-secondary rounded-circle&quot;&gt;
            &lt;i class=&quot;fa-regular fa-phone fs-22 fw- fw-light&quot;&gt;&lt;/i&gt;
            &lt;?php if($totalRows_rsLlamadasDeman &gt; 0 || $totalRows_rsLlamadasProp &gt; 0) { ?&gt;
            &lt;span class=&quot;position-absolute topbar-badge fs-10 translate-middle badge rounded-pill bg-danger&quot;&gt;&lt;?php echo $totalRows_rsLlamadasDeman + $totalRows_rsLlamadasProp; ?&gt;&lt;/span&gt;
            &lt;?php } ?&gt;
        &lt;/a&gt;
    &lt;/div&gt;
&lt;?php endif ?&gt;

&lt;?php if ($actTasks == 1) { ?&gt;
    &lt;?php
    $sWhere = &#039; WHERE DATE(date_due_tsk) &lt;= CURRENT_DATE() AND status_tsk != 2 &#039;;
    if ($_SESSION[&#039;kt_login_level&#039;] &lt; 9) {
        $sWhere .= &#039; AND admin_tsk = &#039; . $_SESSION[&#039;kt_login_id&#039;];
    }

    $query_rsTotalTareas = &quot;
    SELECT
        id_tsk
    FROM tasks
    $sWhere
    &quot;;

    $rsTotalTareas = $inmoconn-&gt;query($query_rsTotalTareas); if(!$rsTotalTareas) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
    $row_rsTotalTareas = mysqli_fetch_assoc($rsTotalTareas);
    $totalRows_rsTotalTareas = mysqli_num_rows($rsTotalTareas);

    ?&gt;
    &lt;div class=&quot;ms-1 header-item&quot;&gt;
        &lt;a href=&quot;/intramedianet/tasks/tasks.php&quot; class=&quot;btn btn-icon btn-topbar btn-ghost-secondary rounded-circle&quot;&gt;
            &lt;i class=&quot;fa-regular fa-list-check fs-22 fw- fw-light&quot;&gt;&lt;/i&gt;
            &lt;?php if($totalRows_rsTotalTareas &gt; 0) { ?&gt;&lt;span class=&quot;position-absolute topbar-badge fs-10 translate-middle badge rounded-pill bg-danger&quot;&gt;&lt;?php echo $totalRows_rsTotalTareas; ?&gt;&lt;/span&gt;&lt;?php } ?&gt;
        &lt;/a&gt;
    &lt;/div&gt;
&lt;?php } ?&gt;

&lt;?php if ($actCalendar == 1): ?&gt;
&lt;?php
if ($_SESSION[&#039;kt_login_level&#039;] == 9) {
    $query_rsTotalEventos = &quot;SELECT citas.id_ct, citas_categories.category_en_ct, citas.inicio_ct, citas.final_ct, citas.titulo_ct FROM citas INNER JOIN citas_categories ON citas.categoria_ct = citas_categories.id_ct WHERE citas.inicio_ct &gt;= CURRENT_DATE() ORDER BY citas.inicio_ct ASC&quot;;
    $rsTotalEventos = $inmoconn-&gt;query($query_rsTotalEventos); if(!$rsTotalEventos) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
    $row_rsTotalEventos = mysqli_fetch_assoc($rsTotalEventos);
    $totalRows_rsTotalEventos = mysqli_num_rows($rsTotalEventos);
} else {
    $query_rsTotalEventos = &quot;SELECT citas.id_ct, citas_categories.category_en_ct, citas.inicio_ct, citas.final_ct, citas.titulo_ct FROM citas INNER JOIN citas_categories ON citas.categoria_ct = citas_categories.id_ct WHERE citas.inicio_ct &gt;= CURRENT_DATE() AND user_ct = &#039;&quot;.$_SESSION[&#039;kt_login_id&#039;].&quot;&#039; ORDER BY citas.inicio_ct ASC&quot;;
    $rsTotalEventos = $inmoconn-&gt;query($query_rsTotalEventos); if(!$rsTotalEventos) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
    $row_rsTotalEventos = mysqli_fetch_assoc($rsTotalEventos);
    $totalRows_rsTotalEventos = mysqli_num_rows($rsTotalEventos);
}
?&gt;
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/includes/inc.topbar.php:229
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
&lt;?php

$query_rsbajadasCount = &quot;SELECT SQL_CALC_FOUND_ROWS properties_bajada.id_baj, properties_properties.referencia_prop as prop_baj, properties_bajada.name_baj, properties_bajada.email_baj, properties_bajada.phone_baj, properties_bajada.lang_baj, properties_bajada.date_baj FROM properties_bajada INNER JOIN properties_properties ON properties_bajada.prop_baj = properties_properties.id_prop&quot;;
$rsbajadasCount = $inmoconn-&gt;query($query_rsbajadasCount); if(!$rsbajadasCount) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
$row_rsbajadasCount = mysqli_fetch_assoc($rsbajadasCount);
$totalRows_rsbajadasCount = mysqli_num_rows($rsbajadasCount);


$query_rsConsultasCount = &quot;SELECT SQL_CALC_FOUND_ROWS properties_consultas_log.id_con, text_con, properties_consultas_log.name_con, properties_consultas_log.email_con, properties_consultas_log.phone_con, properties_consultas_log.lang_con, properties_consultas_log.date_con, properties_consultas_log.lang_con as lang_sort FROM properties_consultas_log &quot;;
$rsConsultasCount = $inmoconn-&gt;query($query_rsConsultasCount); if(!$rsConsultasCount) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
$row_rsConsultasCount = mysqli_fetch_assoc($rsConsultasCount);
$totalRows_rsConsultasCount = mysqli_num_rows($rsConsultasCount);


$query_rsConsultas = &quot;SELECT * FROM properties_enquiries WHERE read_cons = 0&quot;;
$rsConsultas = $inmoconn-&gt;query($query_rsConsultas); if(!$rsConsultas) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
$row_rsConsultas = mysqli_fetch_assoc($rsConsultas);
$totalRows_rsConsultas = mysqli_num_rows($rsConsultas);
?&gt;
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
&lt;?php
$query_rsbajadasCount = &quot;
    SELECT
    properties_bajada.id_baj,
    properties_properties.referencia_prop as prop_baj,
    properties_bajada.name_baj,
    properties_bajada.email_baj,
    properties_bajada.phone_baj,
    properties_bajada.lang_baj,
    properties_bajada.date_baj,
    email_cli
    FROM properties_bajada
    INNER JOIN properties_properties ON properties_bajada.prop_baj = properties_properties.id_prop
    LEFT OUTER JOIN properties_client ON properties_bajada.email_baj = properties_client.email_cli
    WHERE email_cli is null
&quot;;
$rsbajadasCount = $inmoconn-&gt;query($query_rsbajadasCount); if(!$rsbajadasCount) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
$row_rsbajadasCount = mysqli_fetch_assoc($rsbajadasCount);
$totalRows_rsbajadasCount = mysqli_num_rows($rsbajadasCount);

$query_rsConsultasCount = &quot;SELECT SQL_CALC_FOUND_ROWS properties_consultas_log.id_con, text_con, properties_consultas_log.name_con, properties_consultas_log.email_con, properties_consultas_log.phone_con, properties_consultas_log.lang_con, properties_consultas_log.date_con, properties_consultas_log.lang_con as lang_sort FROM properties_consultas_log &quot;;
$rsConsultasCount = $inmoconn-&gt;query($query_rsConsultasCount); if(!$rsConsultasCount) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
$row_rsConsultasCount = mysqli_fetch_assoc($rsConsultasCount);
$totalRows_rsConsultasCount = mysqli_num_rows($rsConsultasCount);

$query_rsConsultas = &quot;SELECT * FROM properties_enquiries WHERE read_cons = 0&quot;;
$rsConsultas = $inmoconn-&gt;query($query_rsConsultas); if(!$rsConsultas) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
$row_rsConsultas = mysqli_fetch_assoc($rsConsultas);
$totalRows_rsConsultas = mysqli_num_rows($rsConsultas);
?&gt;
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/includes/inc.topbar.php:356
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
&lt;?php

$query_rsLlamadasDeman = &quot;
SELECT
 id_cli
FROM   properties_client
WHERE next_call_cli != &#039;&#039; AND next_call_cli &lt;= NOW()
ORDER BY next_call_cli ASC
&quot;;
$rsLlamadasDeman = $inmoconn-&gt;query($query_rsLlamadasDeman); if(!$rsLlamadasDeman) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
$row_rsLlamadasDeman = mysqli_fetch_assoc($rsLlamadasDeman);
$totalRows_rsLlamadasDeman = mysqli_num_rows($rsLlamadasDeman);


$query_rsLlamadasProp = &quot;
SELECT
    id_pro
    FROM properties_owner
    WHERE next_call_pro != &#039;0000-00-00&#039;  AND next_call_pro &lt;= NOW()
    ORDER BY next_call_pro ASC
&quot;;
$rsLlamadasProp = $inmoconn-&gt;query($query_rsLlamadasProp); if(!$rsLlamadasProp) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
$row_rsLlamadasProp = mysqli_fetch_assoc($rsLlamadasProp);
$totalRows_rsLlamadasProp = mysqli_num_rows($rsLlamadasProp);
?&gt;
&lt;li class=&quot;nav-item&quot;&gt;
    &lt;a href=&quot;/intramedianet/llamadas/clients.php&quot; class=&quot;nav-link &lt;?php if(preg_match(&#039;/\/llamadas\//&#039;, $_SERVER[&#039;PHP_SELF&#039;])){ ?&gt;active&lt;?php } ?&gt;&quot;&gt;
        &lt;?php __(&#039;Llamadas&#039;); ?&gt;
        &lt;?php if($totalRows_rsLlamadasDeman &gt; 0 || $totalRows_rsLlamadasProp &gt; 0) { ?&gt;&lt;span class=&quot;badge badge-pill bg-danger&quot;&gt;&lt;?php echo $totalRows_rsLlamadasDeman + $totalRows_rsLlamadasProp; ?&gt;&lt;/span&gt;&lt;?php } ?&gt;
    &lt;/a&gt;
&lt;/li&gt;
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
&lt;?php
if ($_SESSION[&#039;kt_login_level&#039;] == 9) {
        $query_rsLlamadasDeman = &quot;
        SELECT
         id_cli
        FROM   properties_client
        WHERE next_call_cli != &#039;&#039; AND next_call_cli &lt;= NOW()
        ORDER BY next_call_cli ASC
        &quot;;
        $rsLlamadasDeman = $inmoconn-&gt;query($query_rsLlamadasDeman); if(!$rsLlamadasDeman) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
        $row_rsLlamadasDeman = mysqli_fetch_assoc($rsLlamadasDeman);
        $totalRows_rsLlamadasDeman = mysqli_num_rows($rsLlamadasDeman);

        $query_rsLlamadasProp = &quot;
        SELECT
            id_pro
            FROM properties_owner
            WHERE next_call_pro != &#039;0000-00-00&#039;  AND next_call_pro &lt;= NOW()
            ORDER BY next_call_pro ASC
        &quot;;
        $rsLlamadasProp = $inmoconn-&gt;query($query_rsLlamadasProp); if(!$rsLlamadasProp) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
        $row_rsLlamadasProp = mysqli_fetch_assoc($rsLlamadasProp);
        $totalRows_rsLlamadasProp = mysqli_num_rows($rsLlamadasProp);
  } else {
        $query_rsLlamadasDeman = &quot;
            SELECT SQL_CALC_FOUND_ROWS
             id_cli
            FROM properties_client
             WHERE next_call_cli != &#039;&#039;  AND atendido_por_cli = &#039;&quot;.$_SESSION[&#039;kt_login_id&#039;].&quot;&#039;
        &quot;;
        $rsLlamadasDeman = $inmoconn-&gt;query($query_rsLlamadasDeman); if(!$rsLlamadasDeman) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
        $row_rsLlamadasDeman = mysqli_fetch_assoc($rsLlamadasDeman);
        $totalRows_rsLlamadasDeman = mysqli_num_rows($rsLlamadasDeman);

        $query_rsLlamadasProp = &quot;
        SELECT
            id_pro
            FROM properties_owner
            WHERE next_call_pro != &#039;0000-00-00&#039;  AND next_call_pro &lt;= NOW()
            ORDER BY next_call_pro ASC
        &quot;;
        $rsLlamadasProp = $inmoconn-&gt;query($query_rsLlamadasProp); if(!$rsLlamadasProp) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
        $row_rsLlamadasProp = mysqli_fetch_assoc($rsLlamadasProp);
        $totalRows_rsLlamadasProp = mysqli_num_rows($rsLlamadasProp);
    if($sWhere != &#039;&#039;) {
        $sWhere .= &quot; AND  next_call_pro != &#039;&#039;  AND captado_por_pro = &#039;&quot; . $_SESSION[&#039;kt_login_id&#039;] . &quot;&#039; &quot;; //
    } else {
        $sWhere .= &quot;  WHERE  next_call_pro != &#039;&#039;  AND captado_por_pro = &#039;&quot; . $_SESSION[&#039;kt_login_id&#039;]. &quot;&#039; &quot;; //
    }
  }
?&gt;
&lt;li class=&quot;nav-item&quot;&gt;
    &lt;a href=&quot;/intramedianet/llamadas/clients.php&quot; class=&quot;nav-link &lt;?php if(preg_match(&#039;/\/llamadas\//&#039;, $_SERVER[&#039;PHP_SELF&#039;])){ ?&gt;active&lt;?php } ?&gt;&quot;&gt;
        &lt;?php __(&#039;Llamadas&#039;); ?&gt;
        &lt;?php if($totalRows_rsLlamadasDeman &gt; 0 || $totalRows_rsLlamadasProp &gt; 0) { ?&gt;&lt;span class=&quot;badge badge-pill bg-danger&quot;&gt;&lt;?php echo $totalRows_rsLlamadasDeman + $totalRows_rsLlamadasProp; ?&gt;&lt;/span&gt;&lt;?php } ?&gt;
    &lt;/a&gt;
&lt;/li&gt;
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/includes/inc.topbar.php:440
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
&lt;?php

$query_rsTotalEventos = &quot;SELECT citas.id_ct, citas_categories.category_en_ct, citas.inicio_ct, citas.final_ct, citas.titulo_ct FROM citas INNER JOIN citas_categories ON citas.categoria_ct = citas_categories.id_ct WHERE user_ct = &#039;&quot; . $_SESSION[&#039;kt_login_id&#039;] . &quot;&#039; AND  citas.inicio_ct &gt;= CURRENT_DATE() ORDER BY citas.inicio_ct ASC&quot;;
$rsTotalEventos = $inmoconn-&gt;query($query_rsTotalEventos); if(!$rsTotalEventos) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
$row_rsTotalEventos = mysqli_fetch_assoc($rsTotalEventos);
$totalRows_rsTotalEventos = mysqli_num_rows($rsTotalEventos);
?&gt;
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
&lt;?php
if ($_SESSION[&#039;kt_login_level&#039;] == 9) {
    $query_rsTotalEventos = &quot;SELECT citas.id_ct, citas_categories.category_en_ct, citas.inicio_ct, citas.final_ct, citas.titulo_ct FROM citas INNER JOIN citas_categories ON citas.categoria_ct = citas_categories.id_ct WHERE citas.inicio_ct &gt;= CURRENT_DATE() ORDER BY citas.inicio_ct ASC&quot;;
    $rsTotalEventos = $inmoconn-&gt;query($query_rsTotalEventos); if(!$rsTotalEventos) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
    $row_rsTotalEventos = mysqli_fetch_assoc($rsTotalEventos);
    $totalRows_rsTotalEventos = mysqli_num_rows($rsTotalEventos);
} else {
    $query_rsTotalEventos = &quot;SELECT citas.id_ct, citas_categories.category_en_ct, citas.inicio_ct, citas.final_ct, citas.titulo_ct FROM citas INNER JOIN citas_categories ON citas.categoria_ct = citas_categories.id_ct WHERE citas.inicio_ct &gt;= CURRENT_DATE() AND user_ct = &#039;&quot;.$_SESSION[&#039;kt_login_id&#039;].&quot;&#039; ORDER BY citas.inicio_ct ASC&quot;;
    $rsTotalEventos = $inmoconn-&gt;query($query_rsTotalEventos); if(!$rsTotalEventos) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
    $row_rsTotalEventos = mysqli_fetch_assoc($rsTotalEventos);
    $totalRows_rsTotalEventos = mysqli_num_rows($rsTotalEventos);
}
?&gt;
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="sec22">
        <span class="badge badge-dark">22</span> <i class="fas fz-fw fa-bug text-danger"></i> Consultas: Attended pone mostrar en web
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/enquiries-form.php:193
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
&lt;label class=&quot;form-check-label&quot; for=&quot;read_cons&quot;&gt;&lt;?php __(&#039;Marcar como leido&#039;); ?&gt;&lt;/label&gt;
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
&lt;label class=&quot;form-check-label&quot; for=&quot;read_cons&quot;&gt;&lt;?php __(&#039;Respondido&#039;); ?&gt;&lt;/label&gt;
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="sec23">
        <span class="badge badge-dark">23</span> <i class="fas fz-fw fa-bug text-danger"></i> Al asignar un buyer a un empleado que reciba un correo
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/clients-form.php:622
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
//end deleteLog trigger
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
//end Trigger_DeletFromNewsletter trigger


//start addFields trigger
//remove this line if you want to edit the code by hand
function addFields(&$tNG) {
  global $_SESSION;
  $tNG->addColumn("user_cli", "NUMERIC_TYPE", "EXPRESSION", "{SESSION.kt_login_id}");
  $tNG->addColumn("fecha_alta_cli", "DATE_TYPE", "EXPRESSION", date("d-m-Y H:i:s"));
  if ($_SESSION['kt_login_level'] == 7) {
      $tNG->addColumn("atendido_por_cli", "NUMERIC_TYPE", "EXPRESSION", $_SESSION['kt_login_id']);
  }
  return $tNG->getError();
}
//end addFields trigger

//start addLog trigger
//remove this line if you want to edit the code by hand
function addLog(&$tNG) {

  global $_SESSION;

  logBuyer($_SESSION['kt_login_id'], $tNG->getColumnValue('id_cli'), $tNG->getColumnValue('nombre_cli') . ' ' . $tNG->getColumnValue('apellidos_cli'), '1');

}
//end addLog trigger

//start editLog trigger
//remove this line if you want to edit the code by hand
function editLog(&$tNG) {

  global $_SESSION, $_POST, $_GET, $database_inmoconn, $inmoconn;


  $query_rsProp = "SELECT * FROM properties_client WHERE id_cli = ".$_GET['id_cli'];
  $rsProp = mysqli_query($inmoconn ,$query_rsProp) or die(mysqli_error());
  $row_rsProp = mysqli_fetch_assoc($rsProp);
  $totalRows_rsProp = mysqli_num_rows($rsProp);


  logBuyer($_SESSION['kt_login_id'], $row_rsProp['id_cli'], $row_rsProp['nombre_cli'] . ' ' . $row_rsProp['apellidos_cli'], 2);

}
//end editLog trigger

//start deleteLog trigger
//remove this line if you want to edit the code by hand
function deleteLog(&$tNG) {

  global $_SESSION, $_GET, $database_inmoconn, $inmoconn;


  $query_rsProp = "SELECT * FROM properties_client WHERE id_cli = ".$_GET['id_cli'];
  $rsProp = mysqli_query($inmoconn ,$query_rsProp) or die(mysqli_error());
  $row_rsProp = mysqli_fetch_assoc($rsProp);
  $totalRows_rsProp = mysqli_num_rows($rsProp);

  logBuyer($_SESSION['kt_login_id'], $row_rsProp['id_cli'], $row_rsProp['nombre_cli'] . ' ' . $row_rsProp['apellidos_cli'], '5');

}
//end deleteLog trigger

//start Trigger_SendMails trigger
//remove this line if you want to edit the code by hand
function Trigger_SendMails(&$tNG) {

    global $_POST, $_SESSION, $oldprice, $database_inmoconn, $inmoconn, $mailColor;

    $query_rsCli = "SELECT atendido_por_cli, id_cli FROM properties_client WHERE id_cli = ".$tNG->getColumnValue('id_cli');
    $rsCli = mysqli_query($inmoconn,$query_rsCli) or die(mysqli_error());
    $row_rsCli = mysqli_fetch_assoc($rsCli);
    $totalRows_rsCli = mysqli_num_rows($rsCli);

  if($_SESSION['atendido_por_cli'] != $_POST['atendido_por_cli'] && $_POST['atendido_por_cli'] != '') {

      $query_rsUpdateDate = "UPDATE properties_client SET updated_atendido_cli = '" . date("Y-m-d H:i:s") . "' WHERE id_cli = " . $tNG->getColumnValue('id_cli');
      $rsUpdateDate = mysql_query($query_rsUpdateDate, $inmoconn) or die(mysql_error());

      $query_rsUserSend = "SELECT nombre_usr, email_usr, id_usr FROM users WHERE id_usr = ".$_POST['atendido_por_cli'];
      $rsUserSend = mysqli_query($inmoconn,$query_rsUserSend) or die(mysqli_error());
      $row_rsUserSend = mysqli_fetch_assoc($rsUserSend);
      $totalRows_rsUserSend = mysqli_num_rows($rsUserSend);

      if ($totalRows_rsUserSend > 0) {

        ob_start();
        include($_SERVER["DOCUMENT_ROOT"] . '/includes/mailtemplates/template.html');
        $html = ob_get_contents();
        ob_end_clean();

        $body  = '<p>Hola <strong>'.@$row_rsUserSend['nombre_usr'].'</strong> / Hi <strong>'.@$row_rsUserSend['nombre_usr'].'</strong> </p>';
        $body .= '<p>Se te ha asignado a un comprador / You have been assigned to a buyer</p>';
        $body .= '<table border="0" cellpadding="15" cellspacing="0" class="templateButton" style="border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;background-color: #000000;border: 0;border-collapse: separate !important;">
                      <tr>
                          <td valign="middle" class="templateButtonContent">
                              <div mc:edit="std_content01">
                                  <a href="https://'.$_SERVER['HTTP_HOST'] . '/intramedianet/properties/clients-form.php?id_cli=' . $tNG->getColumnValue('id_cli') . '" target="_blank" style="color: #fbe022;font-family: Arial;font-size: 20px;font-weight: 400;letter-spacing: -.5px;line-height: 100%;text-align: center;text-decoration: none;text-transform: uppercase;text-decoration: none; color: #fff;">Ver comprador / View buyer</a>
                              </div>
                          </td>
                      </tr>
                  </table>';

        $html = preg_replace('/{SERVER.HTTP_HOST}/', $_SERVER['HTTP_HOST'], $html);
        $html = preg_replace('/{CONTENT}/', $body , $html);
        $html = preg_replace('/{FOOTER}/', $textMailTempl, $html);
        $html = preg_replace('/{COLOR}/', $mailColor, $html);

        $subject = 'Se te ha asignado a un comprador / You have been assigned to a buyer - ' . $_SERVER['HTTP_HOST'];

        sendAppEmail($row_rsUserSend['email_usr'], '', '', '', $subject, $html);

      }

  }

}
//end Trigger_SendMails trigger

//start Trigger_SetOldValues trigger
//remove this line if you want to edit the code by hand
function Trigger_SetOldValues(&$tNG) {
  global $_POST, $_SESSION, $oldprice, $database_inmoconn, $inmoconn;

  $query_rsCli = "SELECT atendido_por_cli, id_cli FROM properties_client WHERE id_cli = ".$tNG->getColumnValue('id_cli');
  $rsCli = mysqli_query($inmoconn,$query_rsCli) or die(mysqli_error());
  $row_rsCli = mysqli_fetch_assoc($rsCli);
  $totalRows_rsCli = mysqli_num_rows($rsCli);

  $_SESSION['atendido_por_cli'] = $row_rsCli['atendido_por_cli'];
}
//end Trigger_SetOldValues trigger
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/clients-form.php:831
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$upd_properties_client-&gt;registerTrigger(&quot;BEFORE&quot;, &quot;editLog&quot;, 10);
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$upd_properties_client-&gt;registerTrigger(&quot;BEFORE&quot;, &quot;editLog&quot;, 10);
$upd_properties_client-&gt;registerTrigger(&quot;BEFORE&quot;, &quot;Trigger_SetOldValues&quot;, 50);
$upd_properties_client-&gt;registerTrigger(&quot;AFTER&quot;, &quot;Trigger_SendMails&quot;, 60);
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="sec24">
        <span class="badge badge-dark">24</span> <i class="fas fz-fw fa-bug text-danger"></i> Canbiar respondido en inglés por Resolved
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/includes/resources/lang_en.php:179
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$lang[&#039;Respondido&#039;] = &#039;Answered&#039;;
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$lang[&#039;Respondido&#039;] = &#039;Resolved&#039;;
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="sec25">
        <span class="badge badge-dark">25</span> <i class="fas fz-fw fa-bug text-danger"></i> Canbiar Atendido por en inglés por Agent/Employee
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/includes/resources/lang_en.php:725
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$lang[&#039;Atendido por&#039;] = &#039;Attended&#039;;
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$lang[&#039;Atendido por&#039;] = &#039;Agent/Employee&#039;;
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="sec26">
        <span class="badge badge-dark">26</span> <i class="fas fz-fw fa-bug text-danger"></i> Fix websites que importan muchos xmls y da timeout
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/xml/import-cron.php:27
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$query_rsproveedor = &quot;SELECT * FROM xml WHERE activate_xml = 1 &quot;;

            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$query_rsproveedor = &quot;SELECT * FROM xml WHERE activate_xml = 1 AND updated_xml &lt; CURDATE()  ORDER BY RAND()&quot;;
            </code>
        </pre>
        <hr>
        Actualizar el cron a 10 * * * * https://dominio.com/intramedianet/xml/import-cron.php
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="sec27">
        <span class="badge badge-dark">27</span> <i class="fas fz-fw fa-bug text-danger"></i> Fix velocidad al duplicar inmuebles
    </h6>
    <div class="card-body">
        Sustituir el archivo /intramedianet/properties/properties-dupli.php
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="sec28">
        <span class="badge badge-dark">28</span> <i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Si ocultas casas importadas desde XML, salen en la ficha de areas
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/modules/ciudades/properties.php:215
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
if ($_GET[&#039;secc&#039;] == &#039;ven&#039;) {
    $secc = &#039; vendido_prop = 1 &#039;;
} elseif ($_GET[&#039;secc&#039;] == &#039;alq&#039;) {
    $secc = &#039;activado_prop = 0 AND alquilado_prop = 1 &#039;;
} else {
    $secc = &#039;activado_prop = 1 AND vendido_prop = 0&#039;;
}
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$secc = &quot;activado_prop = 1  AND alquilado_prop = 0 AND vendido_prop = 0AND image_img != &#039;&#039; AND force_hide_prop != 1&quot;;
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/modules/zonas/properties.php:238
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
if(isset($_GET[&#039;secc&#039;])){
    if ($_GET[&#039;secc&#039;] == &#039;ven&#039;) {
        $secc = &#039; vendido_prop = 1 &#039;;
    } elseif ($_GET[&#039;secc&#039;] == &#039;alq&#039;) {
        $secc = &#039;activado_prop = 0 AND alquilado_prop = 1 &#039;;
    } else {
        $secc = &#039;activado_prop = 1 AND vendido_prop = 0&#039;;
    }
}else{
    $secc = &#039;activado_prop = 1 AND vendido_prop = 0&#039;;
}
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$secc = &quot;activado_prop = 1  AND alquilado_prop = 0 AND vendido_prop = 0AND image_img != &#039;&#039; AND force_hide_prop != 1&quot;;
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="sec29">
        <span class="badge badge-dark">29</span> <i class="fas fz-fw fa-bug text-danger"></i> Ajustar comprobación de compradores duplicados
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/clients-form.php:430
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
//start Trigger_CheckUnique trigger
//remove this line if you want to edit the code by hand
function Trigger_CheckUnique(&amp;$tNG) {
  global $lang, $database_inmoconn, $inmoconn;


  $query_rsclientes = &quot;SELECT nombre_cli, apellidos_cli, id_cli FROM properties_client WHERE email_cli = &#039;&quot; . $tNG-&gt;getColumnValue(&#039;email_cli&#039;) . &quot;&#039;  AND archived_cli = 1 &quot;;
  $rsclientes = mysqli_query($inmoconn ,$query_rsclientes) or die(mysqli_error());
  $row_rsclientes = mysqli_fetch_assoc($rsclientes);
  $totalRows_rsclientes = mysqli_num_rows($rsclientes);


  $tblFldObj = new tNG_CheckUnique($tNG);
  $tblFldObj-&gt;setTable(&quot;properties_client&quot;);
  $tblFldObj-&gt;addFieldName(&quot;email_cli&quot;);
  if ($totalRows_rsclientes &gt; 0) {
    $tblFldObj-&gt;setErrorMsg($lang[&#039;Cliente archivado&#039;] . &quot;: {email_cli}&quot;);
  } else {
    $tblFldObj-&gt;setErrorMsg($lang[&#039;Registro duplicado&#039;] . &quot;: {email_cli}&quot;);
  }


  return $tblFldObj-&gt;Execute();
}
//end Trigger_CheckUnique trigger
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
//start Trigger_CheckUnique trigger
//remove this line if you want to edit the code by hand
function Trigger_CheckUnique(&amp;$tNG) {
  global $lang, $database_inmoconn, $inmoconn;


  $query_rsclientes = &quot;SELECT nombre_cli, apellidos_cli, id_cli FROM properties_client WHERE (email_cli = &#039;&quot; . $tNG-&gt;getColumnValue(&#039;email_cli&#039;) . &quot;&#039; OR skype_cli = &#039;&quot; . $tNG-&gt;getColumnValue(&#039;email_cli&#039;) . &quot;&#039;)  AND archived_cli = 1 &quot;;
  $rsclientes = mysqli_query($inmoconn ,$query_rsclientes) or die(mysqli_error());
  $row_rsclientes = mysqli_fetch_assoc($rsclientes);
  $totalRows_rsclientes = mysqli_num_rows($rsclientes);


  $tblFldObj = new tNG_CheckUnique($tNG);
  $tblFldObj-&gt;setTable(&quot;properties_client&quot;);
  $tblFldObj-&gt;addFieldName(&quot;email_cli&quot;);
  if ($totalRows_rsclientes &gt; 0) {
    $tblFldObj-&gt;setErrorMsg($lang[&#039;Cliente archivado&#039;] . &quot;: {email_cli}&quot;);
  } else {
    $tblFldObj-&gt;setErrorMsg($lang[&#039;Registro duplicado&#039;] . &quot;: {email_cli}&quot;);
  }


  return $tblFldObj-&gt;Execute();
}
//end Trigger_CheckUnique trigger

//start Trigger_CheckUnique2 trigger
//remove this line if you want to edit the code by hand
function Trigger_CheckUnique2(&amp;$tNG) {
  global $lang;
  $tblFldObj = new tNG_CheckUnique($tNG);
  $tblFldObj-&gt;setTable(&quot;properties_client&quot;);
  $tblFldObj-&gt;addFieldName(&quot;telefono_fijo_cli&quot;);
  $tblFldObj-&gt;setErrorMsg(&quot;The &lt;b&gt;Buyer&lt;/b&gt; already exists (Phone): {telefono_fijo_cli}&quot;);
  return $tblFldObj-&gt;Execute();
}
//end Trigger_CheckUnique2 trigger


//start Trigger_CheckUnique3 trigger
//remove this line if you want to edit the code by hand
function Trigger_CheckUnique3(&amp;$tNG) {
  global $lang;
  $tblFldObj = new tNG_CheckUnique($tNG);
  $tblFldObj-&gt;setTable(&quot;properties_client&quot;);
  $tblFldObj-&gt;addFieldName(&quot;telefono_movil_cli&quot;);
  $tblFldObj-&gt;setErrorMsg(&quot;The &lt;b&gt;Buyer&lt;/b&gt; already exists (Phone 2): {telefono_movil_cli}&quot;);
  return $tblFldObj-&gt;Execute();
}
//end Trigger_CheckUnique3 trigger
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/clients-form.php:732
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$ins_properties_client-&gt;registerTrigger(&quot;BEFORE&quot;, &quot;Trigger_CheckUnique&quot;, 30);
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$ins_properties_client-&gt;registerTrigger(&quot;BEFORE&quot;, &quot;Trigger_CheckUnique&quot;, 30);
$ins_properties_client-&gt;registerTrigger(&quot;BEFORE&quot;, &quot;Trigger_CheckUnique2&quot;, 30);
$ins_properties_client-&gt;registerTrigger(&quot;BEFORE&quot;, &quot;Trigger_CheckUnique3&quot;, 30);
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/clients-form.php:857
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$upd_properties_client-&gt;registerTrigger(&quot;BEFORE&quot;, &quot;Trigger_CheckUnique&quot;, 30);
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$upd_properties_client-&gt;registerTrigger(&quot;BEFORE&quot;, &quot;Trigger_CheckUnique&quot;, 30);
$upd_properties_client-&gt;registerTrigger(&quot;BEFORE&quot;, &quot;Trigger_CheckUnique2&quot;, 30);
$upd_properties_client-&gt;registerTrigger(&quot;BEFORE&quot;, &quot;Trigger_CheckUnique3&quot;, 30);
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="sec30">
        <span class="badge badge-dark">30</span> <i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> En el blog no se cambian las etiquetas image por las imágenes
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/modules/news/new.php:290
            </code>
        </pre>
        Eliminamos:
        <pre>
            <code class="php">
$smarty-&gt;assign(&quot;news&quot;, $news);
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/modules/news/new.php:339
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$smarty-&gt;assign(&quot;images&quot;, $images);
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$smarty-&gt;assign(&quot;images&quot;, $images);

$matches = array();

preg_match_all(&#039;/{image}|{image-left}|{image-right}|{image-pan}/&#039;, (string)$news[0][&#039;contenido&#039;], $matches);

$text = (string)$news[0][&#039;contenido&#039;];

if(!empty($matches[0])){
    if (count($matches[0] &gt; 0)) {
        for ($i=0; $i &lt; count($matches[0]); $i++) {

            switch ($matches[0][$i]) {
                case &#039;{image-right}&#039;:
                    $img = showThumbnail($images[($i)][&#039;image_img&#039;], &#039;/media/images/news/&#039;, 350, 200, $news[0][&#039;titulo&#039;], &#039;img-right&#039;);
                break;

                case &#039;{image-pan}&#039;:
                    $img = showThumbnail($images[($i)][&#039;image_img&#039;], &#039;/media/images/news/&#039;, 1170, 350, $news[0][&#039;titulo&#039;], &#039;img-pan&#039;);
                break;

                case &#039;{image-left}&#039;:
                    $img = showThumbnail($images[($i)][&#039;image_img&#039;], &#039;/media/images/news/&#039;, 350, 200, $news[0][&#039;titulo&#039;], &#039;img-left&#039;);
                break;

                default:
                    $img = &#039;&lt;img src=&quot;/media/images/news/&#039;.$images[($i)][&quot;image_img&quot;].&#039;&quot; class=&quot;img-auto&quot; alt=&quot;&#039;.$images[($i)][&quot;alt&quot;].&#039;&quot; /&gt;&#039;;
                break;
            }

            $text = preg_replace(&#039;/&#039;.$matches[0][$i].&#039;/&#039;, $img, $text, 1);
        }
    }
}

$news[0][&#039;contenido&#039;] = $text;
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="sec31">
        <span class="badge badge-dark">31</span> <i class="fas fz-fw fa-bug text-danger"></i> Cuando se inserto un comprador no se refleja la fecha de cuando se añadió
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/clients-form.php:1004
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$rsUpdate = $inmoconn-&gt;query($query_rsTipos); if(!$rsUpdate) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$rsUpdate = $inmoconn-&gt;query($query_rsUpdate); if(!$rsUpdate) {die(&quot;Error en la consulta: &quot; . $inmoconn-&gt;error);}
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="sec32">
        <span class="badge badge-dark">32</span> <i class="fas fz-fw fa-bug text-danger"></i> El nivel agente no pueden ver todas las casas en la pestaña de Matching
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/interested-clients.php:68
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$conn_inmoconn = new KT_connection($inmoconn, $database_inmoconn);
$isLoggedIn1 = new tNG_UserLoggedIn($conn_inmoconn);
$isLoggedIn1-&gt;addLevel(&quot;7&quot;);
if ($isLoggedIn1-&gt;Execute()) {
    $sWhere = &#039; WHERE user_cli = \&#039;&#039;.$_SESSION[&#039;kt_login_id&#039;].&#039;\&#039; AND  archived_cli = 0 &#039;;
} else {
    $sWhere = &#039; WHERE  archived_cli = 0 &#039;;
}
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$sWhere = &#039; WHERE  archived_cli = 0 &#039;;
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/intramedianet/properties/interested-clients-50.php:65
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$conn_inmoconn = new KT_connection($inmoconn, $database_inmoconn);
$isLoggedIn1 = new tNG_UserLoggedIn($conn_inmoconn);
$isLoggedIn1-&gt;addLevel(&quot;7&quot;);
if ($isLoggedIn1-&gt;Execute()) {

    $sWhere = &#039; WHERE user_cli = \&#039;&#039;.$_SESSION[&#039;kt_login_id&#039;].&#039;\&#039; AND archived_cli = 0 &#039;;

} else {
    $sWhere = &#039; WHERE archived_cli = 0 &#039;;

}
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$sWhere = &#039; WHERE archived_cli = 0 &#039;;
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card mb-4">
    <h6 class="card-header" id="sec33">
        <span class="badge badge-dark">33</span> <i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Las tags del blog no funcionan
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/modules/news/news.php:243
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$tgs = &quot; AND FIND_IN_SET(&#039;&quot; . $tokens[1] . &quot;&#039;, tags_&quot;.$lang.&quot;_nws)&quot;;
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$str_tag = str_replace(&quot;-&quot;,&quot; &quot;,$tokens[1]);

$tgs = &quot; AND FIND_IN_SET(&#039;&quot; . $str_tag . &quot;&#039;, tags_&quot;.$lang.&quot;_nws)&quot;;
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/modules/news/view/partials/sidebar.tpl:17
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
{if isset($resource.tags)}
&lt;h2 class=&quot;pt-4&quot;&gt;Tags&lt;/h3&gt;

&lt;ul class=&quot;list-group&quot;&gt;
{assign var=&quot;tags&quot; value=explode(&#039;,&#039;, $resource.tags)}
{foreach from=&#039;,&#039;|explode:$menuTags item=curr_tag2}
&lt;a href=&quot;{$urlStart}{$url_news}/{$curr_tag2}&quot; class=&quot;list-group-item {if $category == $curr_tag2} text-primary {/if}&quot;&gt;{$curr_tag2}&lt;/a&gt;
{/foreach}
&lt;/ul&gt;
{/if}
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
{if $menuTags != &#039;&#039;}
&lt;h2 class=&quot;pt-4&quot;&gt;Tags&lt;/h3&gt;

&lt;ul class=&quot;list-group&quot;&gt;
    {foreach from=&#039;,&#039;|explode:$menuTags item=curr_tag2}
        {if $curr_tag2 != &#039;&#039;}
            &lt;a href=&quot;{$urlStart}{$url_news}/{$curr_tag2|replace:&quot; &quot;:&quot;-&quot;}&quot;
        class=&quot;list-group-item {if $category == $curr_tag2} text-primary {/if}&quot;&gt;{$curr_tag2}&lt;/a&gt;
        {/if}
    {/foreach}
&lt;/ul&gt;
{/if}
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>

<div class="card">
    <h6 class="card-header" id="sec34">
        <span class="badge badge-dark">34</span> <i class="fas fz-fw fa-bug text-danger"></i> <b>Front:</b> Cuando filtras por tags o categorías, la numeración de la paginación no se actualiza
    </h6>
    <div class="card-body">
        En el archivo:
        <pre>
            <code class="makefile">
/modules/news/news.php:286
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$query=&quot;
    SELECT news.id_nws,
        news.title_&quot;.$lang.&quot;_nws as titulo,
        news.titlew_&quot;.$lang.&quot;_nws as titulometa,
        news.content_&quot;.$lang.&quot;_nws as contenido,
        news.tags_&quot;.$lang.&quot;_nws as tags,
        news.date_nws,
        (SELECT imagen_img FROM news_fotos WHERE noticia_img = id_nws ORDER BY orden_img LIMIT 1) AS img,
        (SELECT alt_&quot;.$lang.&quot;_img FROM news_fotos WHERE noticia_img = id_nws ORDER BY orden_img LIMIT 1) AS alt
    FROM
        news
    WHERE
        news.title_&quot;.$lang.&quot;_nws  != &#039;&#039; AND
        news.content_&quot;.$lang.&quot;_nws != &#039;&#039; AND
        type_nws = 1 AND
        activate_nws = 1

    $tgs

    $ct

    ORDER BY news.date_nws DESC

    LIMIT $cp, $tp&quot;;
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$query=&quot;
    SELECT news.id_nws,
        news.title_&quot;.$lang.&quot;_nws as titulo,
        news.titlew_&quot;.$lang.&quot;_nws as titulometa,
        news.content_&quot;.$lang.&quot;_nws as contenido,
        news.tags_&quot;.$lang.&quot;_nws as tags,
        news.date_nws,
    (SELECT imagen_img FROM news_fotos WHERE noticia_img = id_nws ORDER BY orden_img LIMIT 1) AS img,
    (SELECT alt_&quot;.$lang.&quot;_img FROM news_fotos WHERE noticia_img = id_nws ORDER BY orden_img LIMIT 1) AS alt,
    GROUP_CONCAT(news_categories.category_&quot;.$lang.&quot;_ct SEPARATOR &#039;, &#039;) as categorias

    FROM news

    LEFT JOIN news_news_categories
        ON news.id_nws = news_news_categories.new
    LEFT JOIN news_categories
        ON news_news_categories.cat = news_categories.id_ct


    WHERE news.title_&quot;.$lang.&quot;_nws  != &#039;&#039; AND news.content_&quot;.$lang.&quot;_nws != &#039;&#039; AND type_nws = 1 AND activate_nws = 1

    $tgs

    $ct

    GROUP BY id_nws

    ORDER BY news.date_nws DESC

    LIMIT $cp, $tp&quot;;
            </code>
        </pre>
        <hr>
        En el archivo:
        <pre>
            <code class="makefile">
/modules/news/news.php:333
            </code>
        </pre>
        Cambiar:
        <pre>
            <code class="php">
$_query = &quot;

    SELECT news.id_nws

    FROM news

    WHERE news.title_&quot;.$lang.&quot;_nws  != &#039;&#039; AND news.content_&quot;.$lang.&quot;_nws != &#039;&#039; AND type_nws = 1 AND activate_nws = 1

 AND news.content_&quot;.$lang.&quot;_nws != &#039;&#039; AND type_nws = 1

    $ct
&quot;;
            </code>
        </pre>
        Por:
        <pre>
            <code class="php">
$_query = &quot;

        SELECT news.id_nws

        FROM news

         LEFT JOIN news_news_categories
            ON news.id_nws = news_news_categories.new
        LEFT JOIN news_categories
            ON news_news_categories.cat = news_categories.id_ct

        WHERE news.title_&quot;.$lang.&quot;_nws  != &#039;&#039; AND news.content_&quot;.$lang.&quot;_nws != &#039;&#039; AND type_nws = 1 AND activate_nws = 1

        $tgs

        $ct
&quot;;
            </code>
        </pre>
    </div>
    <div class="card-footer text-muted">
        <a href="#" class="float-right text-secondary toTop"><i class="fas fz-fw fa-arrow-circle-up"></i></a>
    </div>
</div>
